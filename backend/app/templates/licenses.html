{% extends "base.html" %}

{% block content %}
<div class="mb-8 flex justify-between items-center">
    <div>
        <h2 class="text-3xl font-bold text-white">License Management</h2>
        <p class="text-gray-400 mt-1">Manage user access keys</p>
    </div>
    <button onclick="document.getElementById('createModal').classList.remove('hidden')"
        class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium shadow-lg transition-colors flex items-center">
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
        </svg>
        Generate License
    </button>
</div>

<!-- Licenses Table -->
<div class="bg-gray-800 rounded-xl border border-gray-700 shadow-lg overflow-hidden">
    <div class="overflow-x-auto">
        <table class="w-full text-left">
            <thead>
                <tr class="bg-gray-700/50 text-gray-400 text-sm uppercase tracking-wider">
                    <th class="px-6 py-4 font-medium">License Key</th>
                    <th class="px-6 py-4 font-medium">Owner</th>
                    <th class="px-6 py-4 font-medium">Expiry</th>
                    <th class="px-6 py-4 font-medium">Status</th>
                    <th class="px-6 py-4 font-medium text-right">Actions</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-gray-700">
                {% for license in licenses %}
                <tr class="hover:bg-gray-700/30 transition-colors">
                    <td class="px-6 py-4 font-mono text-blue-400">{{ license.key }}</td>
                    <td class="px-6 py-4 text-white font-medium">{{ license.owner }}</td>
                    <td class="px-6 py-4 text-gray-300">{{ license.expiry }}</td>
                    <td class="px-6 py-4">
                        {% if license.status == 'active' %}
                        <span
                            class="px-2 py-1 rounded-full text-xs font-bold bg-green-900/50 text-green-400 border border-green-800">Active</span>
                        {% else %}
                        <span
                            class="px-2 py-1 rounded-full text-xs font-bold bg-red-900/50 text-red-400 border border-red-800">Inactive</span>
                        {% endif %}
                    </td>
                    <td class="px-6 py-4 text-right">
                        <form action="/dashboard/licenses/delete" method="post"
                            onsubmit="return confirm('Are you sure?');" class="inline">
                            <input type="hidden" name="key" value="{{ license.key }}">
                            <button type="submit" class="text-red-400 hover:text-red-300 transition-colors">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
                                    </path>
                                </svg>
                            </button>
                        </form>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="5" class="px-6 py-8 text-center text-gray-500">No licenses found.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- Create Modal -->
<div id="createModal" class="fixed inset-0 bg-black/70 hidden flex items-center justify-center z-50 backdrop-blur-sm">
    <div
        class="bg-gray-800 rounded-xl shadow-2xl border border-gray-700 w-full max-w-md p-6 transform transition-all scale-100">
        <h3 class="text-xl font-bold text-white mb-4">Generate New License</h3>
        <form action="/dashboard/licenses" method="post">
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-400 mb-1">Owner Name</label>
                <input type="text" name="owner" required
                    class="w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 focus:outline-none">
            </div>
            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-400 mb-1">Duration (Days)</label>
                <select name="days"
                    class="w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 focus:outline-none">
                    <option value="30">30 Days (1 Month)</option>
                    <option value="90">90 Days (3 Months)</option>
                    <option value="365">365 Days (1 Year)</option>
                    <option value="9999">Lifetime</option>
                </select>
            </div>
            <div class="flex justify-end space-x-3">
                <button type="button" onclick="document.getElementById('createModal').classList.add('hidden')"
                    class="px-4 py-2 text-gray-400 hover:text-white transition-colors">Cancel</button>
                <button type="submit"
                    class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-bold shadow-lg">Generate</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}